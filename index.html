<!DOCTYPE html>
<html lang="en">

<head>
    <!-- <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <title>Document</title>
    <script>
        testFun = function () {
            console.log('HTML loaded successfully');
            callCeckStorageAccess();
        }

        function callCeckStorageAccess() {
            if (document.hasStorageAccess()) {
                document.hasStorageAccess().then(hasAccess => {
                    if (hasAccess) {
                        console.log("document.hasStorageAccess");
                        // window.location.reload();
                    } else {
                        // return document.requestStorageAccess()
                    }
                }).then(_ => {
                    // example from MDN
                    // console.log("3rd party: document.cookie=", document.cookie)
                    // document.cookie = "foo=bar";              // set a cookie
                    // const key = "KEY";
                    // console.log("window.localStorage[KEY]=", window.localStorage[key])

                    // console.log("document=", document)
                    // console.log("window=", window)
                    // console.log("window.parent=", window.parent)
                    // console.log("window.parent.document=", window.parent.document)

                }).catch(reason => {
                    console.log("Some promise have failed, reason=", reason)
                })
            }
        }

        function callRequestStorageAccess() {
            console.log('clocked');
            // window.location.reload();
            var promise = document.requestStorageAccess();
            promise.then(
                function () {
                    console.log('storage access granted');
                    console.log(window.cookie);
                },
                function () {
                    console.log('storage access declined');
                }
            );
        }
    </script>
</head>

<body>
    <button> Get Storage Access</button>
    <iframe src="https://ny.matrix-uat.ms.com/eqr/research/webapp/static/bot/index.html"
        style="height: 600px;width: 400px;" sandbox="allow-storage-access-by-user-activation
    allow-scripts
    allow-same-origin" onload="callCeckStorageAccess()"></iframe>

</body>

</html>
